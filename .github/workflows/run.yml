name: UpdateWeatherSite

on:
  push:                   # 只要你修改代码提交，就会触发更新
  schedule:
    - cron: '0 * * * *'   # 核心修改：这代表每个整点（0分）都会自动运行一次
  workflow_dispatch:      # 允许你在 Actions 页面手动点击运行

# 第 12 行通常在这里，确保 permissions 和 contents 之间缩进正确
permissions:
  contents: write

jobs:
  run_bot:
    runs-on: ubuntu-latest
    steps:
      - name: 检出代码
        uses: actions/checkout@v3

      - name: 安装依赖
        run: pip install requests

      - name: 运行脚本
        env:
          BARK_KEY: ${{ secrets.BARK_KEY }}
        run: python index.py

      - name: 自动提交更新
        run: |
          git config --global user.name "WeatherBot"
          git config --global user.email "bot@github.com"
          git add index.html
          git commit -m "Auto Update Weather" || echo "No changes"
          git push
