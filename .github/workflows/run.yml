name: UpdateWeatherSite

on:
  push:
  schedule:
    - cron: '20 00 * * *'

# 第 12 行通常在这里，确保 permissions 和 contents 之间缩进正确
permissions:
  contents: write

jobs:
  run_bot:
    runs-on: ubuntu-latest
    steps:
      - name: 检出代码
        uses: actions/checkout@v3

      - name: 安装依赖
        run: pip install requests

      - name: 运行脚本
        env:
          BARK_KEY: ${{ secrets.BARK_KEY }}
        run: python index.py

      - name: 自动提交更新
        run: |
          git config --global user.name "WeatherBot"
          git config --global user.email "bot@github.com"
          git add index.html
          git commit -m "Auto Update Weather" || echo "No changes"
          git push
